---
section: 准备阶段
nav_order: 7
title: 1.1.7 云服务与CDN选型
---
> 网站的托管方案直接影响页面加载速度、可用性和运维成本。加载速度是 Google 的排名因素之一，而 CDN 可以显著改善全球用户的访问体验。本节将对比主流云服务和 CDN 方案，帮助你做出最优选择。

## 云服务基础概念

### 你需要什么样的托管方案

根据网站类型，你需要的托管方案可能差异很大：

| 网站类型 | 推荐方案 | 月费参考 |
|----------|----------|----------|
| 静态网站/博客 | Cloudflare Pages / Vercel / Netlify | $0（免费） |
| WordPress 站点 | VPS 或 Managed WordPress Hosting | $5-50 |
| 动态 Web 应用 | VPS 或云服务器 | $5-100 |
| 电商网站 | Shopify 或 VPS + WooCommerce | $29-100 |
| 大型内容站群 | 云服务器集群 | $50-500+ |

### 关键性能指标

- **TTFB（首字节时间）**：服务器响应第一个字节的时间，理想值 < 200ms
- **Uptime（可用性）**：99.9% 以上为合格，99.99% 为优秀
- **带宽**：影响并发用户数和文件传输速度
- **地理位置**：服务器越靠近目标用户，速度越快

## 主流云服务商对比

### Cloudflare

**适合**：几乎所有类型的网站都应该使用 Cloudflare，至少作为 DNS 和 CDN 层。

| 项目 | 详情 |
|------|------|
| **核心服务** | DNS、CDN、WAF、DDoS 防护、Workers |
| **免费套餐** | DNS 管理、CDN 加速、SSL 证书、基本 WAF |
| **Pro 套餐** | $20/月，增加更多安全规则和性能优化 |
| **Pages** | 免费静态网站托管，支持 CI/CD |
| **Workers** | Serverless 计算，免费 100,000 次/天 |

**为什么 Cloudflare 是首选：**
1. 全球 300+ 个节点，覆盖几乎所有国家
2. 免费套餐功能强大，足够大部分网站使用
3. 一键开启 SSL、HTTP/3、自动压缩
4. 内置 DDoS 防护，安全性高
5. DNS 解析速度全球最快
6. Cloudflare Pages 可免费托管静态网站

### AWS（Amazon Web Services）

**适合**：有技术能力、需要高度自定义的中大型项目。

| 常用服务 | 功能 | 月费参考 |
|----------|------|----------|
| EC2 | 虚拟服务器 | $3.5-100+（视配置） |
| Lightsail | 简化版 VPS | $3.5 起 |
| S3 | 对象存储 | $0.023/GB |
| CloudFront | CDN | $0.085/GB（前 10TB） |
| Route 53 | DNS 服务 | $0.50/域名/月 |

**AWS 优势：**
- 服务最全、生态最大
- 全球基础设施覆盖最广
- 免费套餐（12 个月内大量服务免费试用）
- 适合后期业务规模化

**AWS 劣势：**
- 学习曲线陡峭
- 定价复杂，不注意可能产生意外费用
- 小型项目性价比不高

### GCP（Google Cloud Platform）

**适合**：与 Google 生态深度集成的项目。

| 常用服务 | 功能 | 月费参考 |
|----------|------|----------|
| Compute Engine | 虚拟服务器 | $4-100+ |
| Cloud Run | Serverless 容器 | 按使用量计费 |
| Cloud Storage | 对象存储 | $0.020/GB |
| Cloud CDN | CDN | $0.08/GB |
| Firebase Hosting | 静态网站托管 | 免费版够用 |

**GCP 优势：**
- 网络质量极高（Google 自有光纤网络）
- 与 Google 其他服务集成好
- BigQuery 数据分析能力强
- 免费额度慷慨（$300 试用金，90 天）

### VPS 供应商

对于中小型网站，VPS（虚拟专用服务器）通常是性价比最高的选择。

| 供应商 | 最低配置月费 | 数据中心 | 特点 |
|--------|------------|----------|------|
| **Vultr** | $2.5/月 | 32 个城市 | 按小时计费、全球节点多 |
| **DigitalOcean** | $4/月 | 15 个城市 | 文档优秀、一键安装镜像多 |
| **Linode (Akamai)** | $5/月 | 25+ 个城市 | 稳定、性价比高 |
| **Hetzner** | €3.29/月 | 欧洲+美国 | 欧洲市场首选、极高性价比 |
| **BandwagonHost** | $49.99/年 | 美国+亚洲 | 中国用户线路优化 |

### 推荐方案

**起步阶段推荐：**
```
Cloudflare（DNS + CDN + SSL）
  +
Vultr/DigitalOcean VPS（$5-10/月）
  或
Cloudflare Pages（静态站免费）
```

**成长阶段推荐：**
```
Cloudflare Pro（$20/月）
  +
AWS Lightsail 或 EC2
  +
AWS S3（图片和静态资源存储）
```

## CDN 配置详解

### 什么是 CDN

CDN（Content Delivery Network，内容分发网络）将你的网站内容缓存到全球多个节点。用户访问时，从距离最近的节点获取内容，从而大幅降低加载时间。

### CDN 对 SEO 的影响

1. **提升页面速度**：直接影响 Core Web Vitals 评分
2. **改善用户体验**：减少跳出率，提升停留时间
3. **提高可用性**：即使源服务器宕机，CDN 缓存仍可提供服务
4. **全球覆盖**：无论用户在哪个国家，都能快速加载

### Cloudflare CDN 配置指南

#### 第一步：将域名 DNS 迁移到 Cloudflare

1. 在 Cloudflare 添加你的域名
2. Cloudflare 会自动扫描现有 DNS 记录
3. 确认 DNS 记录无误
4. 到域名注册商处修改 NS（Name Server）记录为 Cloudflare 提供的值
5. 等待 DNS 生效（最长 24-48 小时，通常几小时）

#### 第二步：配置 SSL/TLS

| 模式 | 说明 | 推荐 |
|------|------|------|
| Off | 不加密 | 不推荐 |
| Flexible | Cloudflare 到用户加密，到源站不加密 | 不推荐 |
| Full | 两段都加密，但不验证源站证书 | 一般 |
| Full (Strict) | 两段都加密，验证源站证书 | 推荐 |

推荐使用 **Full (Strict)** 模式，并在源站安装 Cloudflare Origin CA 证书。

#### 第三步：性能优化设置

在 Cloudflare Dashboard 中开启以下选项：

1. **Auto Minify**：自动压缩 HTML、CSS、JavaScript
2. **Brotli 压缩**：比 gzip 更高效的压缩算法
3. **HTTP/3 (QUIC)**：最新的 HTTP 协议，减少连接延迟
4. **Early Hints**：预加载关键资源
5. **Rocket Loader**：优化 JavaScript 加载（需测试是否影响功能）
6. **Polish**（Pro 版）：自动优化图片
7. **Mirage**（Pro 版）：延迟加载图片

#### 第四步：缓存规则设置

```
推荐缓存策略：

静态资源（CSS/JS/图片）
  → 缓存时间：1 个月
  → 浏览器缓存TTL：1 个月

HTML 页面
  → 缓存时间：2-4 小时
  → 浏览器缓存TTL：不缓存或短时间

API 接口
  → 不缓存（Bypass Cache）
```

#### 第五步：安全设置

1. **WAF 规则**：开启 Cloudflare 托管规则
2. **Bot 管理**：开启 Bot Fight Mode
3. **速率限制**：对登录页等敏感页面设置速率限制
4. **IP 访问规则**：按需封禁恶意 IP

## 成本优化策略

### 降低服务器成本

1. **使用缓存减少源站压力**：Cloudflare 可以缓存大部分请求
2. **静态资源外存**：图片存储在 S3 或 Cloudflare R2（免出站费）
3. **按需扩展**：使用自动伸缩而非固定大规格服务器
4. **预留实例**：如果使用 AWS，预留实例比按需便宜 30-60%
5. **选择合适的地区**：美国东部（us-east-1）通常最便宜

### 免费方案最大化

| 服务 | 免费额度 | 适用场景 |
|------|----------|----------|
| Cloudflare Free | CDN + DNS + SSL 无限制 | 所有网站 |
| Cloudflare Pages | 每月 500 次构建，无限请求 | 静态站 |
| Cloudflare R2 | 10GB 存储，免出站费 | 图片/文件存储 |
| Vercel | 每月 100GB 带宽 | Next.js 项目 |
| Netlify | 每月 100GB 带宽 | 静态站 |
| AWS Free Tier | EC2 750 小时/月（12 个月） | 新用户试用 |
| GCP Free Tier | $300 试用金（90 天） | 新用户试用 |

### 月度成本预算参考

| 阶段 | 配置方案 | 月费预估 |
|------|----------|----------|
| 起步期 | Cloudflare Free + Vultr $5 VPS | $5 |
| 成长期 | Cloudflare Pro + DigitalOcean $20 VPS | $40 |
| 规模期 | Cloudflare Business + AWS 多服务 | $100-500 |

## 配置完成清单

- [ ] 选择了合适的云服务/VPS 方案
- [ ] 服务器已购买并完成基本配置
- [ ] Cloudflare 账号已注册
- [ ] 域名 DNS 已迁移到 Cloudflare
- [ ] SSL/TLS 已设置为 Full (Strict) 模式
- [ ] CDN 缓存规则已配置
- [ ] 已开启 Auto Minify、Brotli、HTTP/3
- [ ] 安全设置已完成（WAF、Bot 管理）
- [ ] 使用 PageSpeed Insights 测试页面速度达标
- [ ] 已了解月度成本并设置预算上限提醒
